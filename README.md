# HemodynLCBC
Pet-project that simulates the hemodynamics of the large circle of blood circulation. 
The project was inspired by a real-life task for medical engineers that was presented on [the website of the Sechenov MSMU.](https://theranostic.sechenov.ru/caseheart)

## Content

<details>
<summary>Original task and the problems associated with it</summary>

  <br>
  
  Оригинальную задачу вы можете посмотреть [здесь](https://theranostic.sechenov.ru/caseheart)
  
  Тут я продублирую её текст на английском языке и расскажу какие трудности возникли при попытке её решения. Задача:
  
  <img align="right" width="35%" height="500" alt="OriginalTask_EN" src="https://github.com/user-attachments/assets/c4312afc-cf27-4dcb-a73d-0f69d3bffbf6" />
  Для изучения процессов, происходящих в системе кровообращения, влияния имплантируемых медицинских устройств таких как искусственные клапаны сердца и аппараты вспомогательного кровообращения используются модели системы кровообращения. Модели позволяют персонализировано определить оптимальное состояние пациента и могут входить в систему поддержки принятия врачебных решений.

Необходимо промоделировать большой круг кровообращения используя любой из программных пакетов (Matlab, Python, C++ и др). Система дифференциальных уравнений приставлена в приложении (формула (6)), для численного решения её необходимо преобразовать по методу Эйлера, обобщённому для систем дифференциальных уравнений. Параметры модели представлены в приложении (таблица 1).

В приложении представлены краткая теория и необходимые для моделирования формулы, параметры модели, вектор начальных значений для системы дифференциальных уравнений.
Ответом на задачу является значение систолического давления в аорте для последнего цикла (округлить до целого значения).

  <br>
  <br>
  <br>
  <br>
  
  Основное, с чем пришлось столкнуться - это отсутсвие материалов, которые нужны для решения задачи. 
  Поэтому я сразу решил посмотреть её решение и пойти от обратного. Так я узнал примерные параметры модели:

| Обозначение       | Значение | Ед. изм. | Краткое описание                                |
|       :---:       |   :---:  |  :---:   |  :---                                           |
| R1                | 1        | усл. ед. | Сопротивление участка сосудов системного круга  |
| R2                | 0.005    | усл. ед. | Сопротивление клапана/соединения между камерами |
| R3                | 0.013    | усл. ед. | Сопротивление сосуда (аорта/крупный сосуд)      |
| R4                | 0.0398   | усл. ед. | Периферическое сосудистое сопротивление         |
| C2                | 4.4      | усл. ед. | Ёмкость (комплаенс) второго сосуда/камеры       |
| C3                | 1.33     | усл. ед. | Ёмкость третьего сосуда/камеры                  |
| C4                | 0.8      | усл. ед. | Ёмкость четвёртого сосуда/камеры                |
| L                 | 0.0005   | усл. ед. | Индуктивность (инерция потока крови)            |
| V0                | 10       | усл. ед. | Опорный объём камеры (например, желудочка)      |
| dt                | 0.01     | с        | Шаг интегрирования (метод Эйлера)               |
| HR                | 75       | уд/мин   | Частота сердечных сокращений                    |
| Umax              | 2        | усл. ед. | Максимальная эластичность желудочка             |
| Umin⁡              | 0.05     | усл. ед. | Минимальная эластичность желудочка              |
| N                 | 10       | циклов   | Число сердечных циклов для моделирования        |

И вектор X

| Обозначение      | Значение | Ед. изм. | Краткое описание                                |
|  :---:           |  :---:   |  :---:   |  :---                                           |
| x1               | 8        | усл. ед. | Давление в желудочке                            |
| x2               | 7.3      | усл. ед. | Давление в предсердии                           |
| x3               | 70       | усл. ед. | Давление в артерии                              |
| x4               | 75       | усл. ед. | Давление в аорте                                |
| x5               | 20       | усл. ед. | Скорость кровотока, насколько я понял           |

А также формулы. Компактная запись системы ОДУ для моделирования большого круга кровообращения:



Теперь вы можете все это использовать, чтобы решить задачу с самого начала =)
Если что, то я постарался максимально прокомментировать свой код, чтобы вы могли разобраться с ним в случае возникщих трудностей.

### Важно:
1. Некоторые комментарии и обозначения могут быть неверными, т.к. проект делался и изучался самостоятельно и я не являюсь экспертом в этой области.
2. Этот проект нельзя использовать для решения реальных медицинских задач - это учебный проект и он не отражает в полной мере то, что происходит в организме человека.

Я всегда открыт к разговору и рад общению с вами, поэтому если у вас есть какие-то правки и вы лучше меня в этом разбираетесь (являетесь экспертом) - просто напишите мне об ошибке. Нет такого человека, который знает все на этом свете и не ошибается только тот, кто ничего не делает.

<br>

> P.S. Вот некоторые полезные материалы, которые помогли мне в решении задачи. Возможно и вам они смогут помочь:
>
> P. I. Begun - Biomechanics (ISBN 5-7325-0309-5)
> > Есть главы посвященные биомеханике сердца и сосудистой системы. Еще во время самостоятельного изучения биомеханики столкнулся с этим учебником - написан достаточно простым языком
> 
> B. I. Tkachenko - The basis of human physiology. A manual for the higher educational schools, in 2 volumes (ISBN 5-86050-055-6)
> > Также есть главы посвященные вопросам гемодинамики. По большей части я использовал этот учебник уже для проверки того, что получилось у меня. В нем также есть полезные материалы для решения задачи.
> 
> L. Formaggia, A. Quarteroni, A. Veneziani Eds. - Cardiovascular mathematics. Modeling and simulation of the circulatory system (ISBN 978-88-470-1151-9)
> > Книга максимально подходит к теме, т.к. её и описывает, но мне показалась тяжелой для чтения и понимания. Очень много формул. Тем не менее, тоже полезна и может вам она поможет больше, чем мне
<br>
</details>



<details>
<summary>My decision and the results</summary>

</details>

## Requirements
